"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(a,u){var e={banners:[],init:function(){var e=function(){var e=a.getElementsByTagName("*"),t=[];for(var n in e){var i=e[n];i.dataset&&i.dataset.baId&&(i.dataset.baId,t.push(i))}return t}();for(var t in e){var n=e[t],i=n.dataset;n.events={onAdLoaded:r("on-ad-loaded",n),onAdFailed:r("on-ad-failed",n),onAdImpression:r("on-ad-impression",n)},s(n,i);var o={_clientID:void 0,clientID:function(e){return e?(this._clientID=e,this):this._clientID},_element:void 0,element:function(e){return e?(this._element=e,this):this._element},_data:void 0,data:function(e){return e?(this._data=e,this):this._data}};o.clientID(i.baClientId),o.data(i),o.element(n),this.banners.push(o)}}};function r(e,t){var n;return a.createEvent?(n=a.createEvent("HTMLEvents")).initEvent(e,!0,!0):(n=a.createEventObject()).eventType=e,n.eventName=e,n.trigger=function(){a.createEvent?t.dispatchEvent(n):t.fireEvent("on"+n.eventType,n)},n}function s(i,e){var o=new XMLHttpRequest,t=function(e){var t={video:"result.json",banner:"result2.json",default:"result3.json"};return t[e]||t.default}(e.baType),r=null;o.onload=function(){if(200===o.status)try{r=JSON.parse(o.responseText)}catch(e){}if(r)switch(r.type){case"VIDEO":var e=a.createElement("iframe");e.src=r.video_url,i.appendChild(e),e.addEventListener("load",function(){l(i,d(i),r.impression_url)}),i.events.onAdLoaded.trigger(),u.addEventListener("scroll",function(){l(i,d(i),r.impression_url)});break;case"BANNER":var t=a.createElement("img");t.src=r.image,t.style.maxWidth="100%",i.appendChild(t),t.addEventListener("load",function(){l(i,d(i),r.impression_url)}),u.addEventListener("scroll",function(){l(i,d(i),r.impression_url)}),i.events.onAdLoaded.trigger();break;default:var n=a.createElement("h4");n.innerHTML="nothing...",i.appendChild(n),i.events.onAdFailed.trigger()}},o.open("GET",t),o.send()}function d(e){var t=function(e){var t,n,i={top:0,left:0},o=e&&e.ownerDocument;return t=o.documentElement,"undefined"!==_typeof(e.getBoundingClientRect)&&(i=e.getBoundingClientRect()),n=function(e){return function(e){return null!=e&&e===e.window}(e)?e:9===e.nodeType&&e.defaultView}(o),{x:i.left+n.pageXOffset-t.clientLeft,y:i.top+n.pageYOffset-t.clientTop,width:e.offsetWidth,height:e.offsetHeight,xMax:function(){return this.x+this.width},yMax:function(){return this.y+this.height}}}(e),n=t.width*t.height,i=u.scrollX,o=u.scrollY,r=u.scrollX+u.innerWidth,a=u.scrollY+u.innerHeight,s=(o>t.y?o-t.y:0)+(a<t.yMax()?t.yMax()-a:0),d=(i>t.x?i-t.x:0)+(r<t.xMax()?t.xMax()-r:0),l=1e4*((t.height-s)*(t.width-d))/n/100;return t.percentage=l,t}function l(t,e,n){50<d(t).percentage&&1!=t.donelog&&1!=t.sending&&(t.sending=1,setTimeout(function(){if(50<d(t).percentage){t.events.onAdImpression.trigger();var e=new XMLHttpRequest;e.onload=function(){t.donelog=1,t.sending=0},e.onerror=function(){t.donelog=1,t.sending=0},e.open("GET",n),e.send()}},1e3))}u.BROADCAST=e,console.info}(document,window);